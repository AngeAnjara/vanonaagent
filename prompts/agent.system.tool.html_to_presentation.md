# Tool: html_to_presentation

Description (FR): Convertit un fichier HTML (généré par `html_design`) en présentation PowerPoint (PPTX) ou PDF. Détecte les éléments `.slide` et crée une diapositive par section via capture d'écran (ou une seule capture pleine page si aucune diapositive n'est détectée). L'utilisateur peut prévisualiser le HTML et demander des améliorations avant conversion.

Description (EN): Converts an HTML file (generated by `html_design`) to PowerPoint (PPTX) or PDF presentation. Detects `.slide` elements and creates one slide per section via screenshot (or a single full-page screenshot if none are found). Users can preview HTML and request improvements before conversion.

Arguments:
- html_path (string, required): Path to HTML file (from `html_design` output).
- output_format (string, optional): "pptx" or "pdf". Default from settings.
- output_name (string, optional): Output filename (without extension). Default: "presentation_{timestamp}".

Behavior:
- Reads HTML file and detects `.slide` containers when present.
- For PPTX: Uses Playwright to screenshot each slide (or full page) and `python-pptx` to assemble images into slides.
- For PDF: Uses `weasyprint` or `pdfkit` to convert HTML to PDF.
- Saves to `outputs/presentations/{output_name}.{format}`.

Examples:

```json
{
  "thoughts": ["Convert the designed HTML to PowerPoint"],
  "headline": "Converting to PPTX",
  "tool_name": "html_to_presentation",
  "tool_args": {
    "html_path": "outputs/presentations/design_1234567890.html",
    "output_format": "pptx",
    "output_name": "Q4_Sales_Presentation"
  }
}
```

```json
{
  "thoughts": ["User prefers PDF format for sharing"],
  "headline": "Converting to PDF",
  "tool_name": "html_to_presentation",
  "tool_args": {
    "html_path": "outputs/presentations/design_1234567890.html",
    "output_format": "pdf",
    "output_name": "Business_Plan_2024"
  }
}
```

Bonnes pratiques / Best practices:
- Toujours utiliser `html_design` d'abord pour générer le HTML.
- Structurer le HTML avec des conteneurs `.slide` pour générer plusieurs diapositives.
- Prévisualiser le HTML avant conversion (ouvrir dans navigateur).
- Si l'utilisateur demande des améliorations, régénérer avec `html_design` puis reconvertir.
- Pour PPTX, vérifier que `python-pptx` est installé (`pip install python-pptx`).
- Pour PDF, vérifier que `weasyprint` ou `pdfkit` est installé.

Erreurs courantes / Common errors:
- "PowerPoint generation is disabled" → Activer dans Settings.
- "HTML file not found" → Vérifier que `html_path` est correct.
- "Missing library: python-pptx" → Installer avec `pip install python-pptx`.
- "Playwright browsers not installed" → Exécuter `playwright install`.
